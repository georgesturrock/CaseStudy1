---
title: "CS1Markdown1"
author: "George Sturrock"
date: "June 27, 2017"
output: html_document
---

## Introduction
The analysis presented in this presentation is based upon Gross Domestic Product (GDP) and Educational Statistics data freely available from the World Bank (http://data.worldbank.org/data-catalog).  The GDP Ranking data is a simple data set containing actual GDP and a ranking of 190 different countries.  The Educational Statistics data contains core education indicators from the UNESCO Institute for Statistics (UIS).  This document describes the methods implemented to import, cleanse, merge and analzye the GDP and Eductational Statistics data sets.

## Code
All coding for this analysis was created using R Studio to create R Script files.  A single R Make-like file named "Makefile.R" was created to execute the data import, cleansing and analysis processes.  The code sourced by "Makefile.R" is divided into four different R script files:  CS1loadLibraries.R, CS1DLoadandRead.R, CS1CleanseData.R and CS1AnalyzeData.R.  Additional details for each R script file are presented below.

### Libraries
In addition to base R libraries and packages, downloader, dyplr and ggplot2 are loaded to assist with data importing, cleansing and analysis.

```{r lib, results='hide', message=FALSE}
source("CS1LoadLibraries.R")
```

### Data Import
The data is donwloaded directly from the World Bank data catalog.  After the data is successfully downloaded to the R project's working directory, two data frames are created for use within the R scripts:  GDPdata and FedStats.

```{r}
source("CS1DLoadandRead.R")
head(GDPdata)
head(FedStats)
```

### Data Cleansing and Merging
The data cleansing and merging script prepares the GDP and Educational Statistics data for analysis.  The script begins by deleting blank columns from the GDP data.  GDP data columns are then renamed to enhance readability of the data frame and future code.  The GDP data also has several rows with a blank country code.  These rows are removed.  GDP data columns are then coerced to the correct data types to allow for accurate analysis.  The GDP data also contains two different sets of data in the same file.  Rows 1 through 217 contain GDP rankings.  The rows higher than 217 contain GDP by income group.  An income group data frame is created for future analysis.  GDP data is subset of only include just GDP data at a country code level.  The resulting data frame is named "JustGDPdata".  

The Educational Statistics are fairly clean.  "FedStats" is merged with "JustGDPdata" to create a consolidated data fram named "MergeGDPandStat".  This will be the primary data frame used for analysis.  The number of matches during the merge is recorded and displayed.  "MergeGDPandStat" is then subset of include on those rows with a GDP Ranking.  

```{r cleanse, warning=FALSE}
source("CS1CleanseData.R")
head(MergeGDPandStat)
```

### Data Analysis
The data analysis section addresses the data analysis requirements specified in the Case Study document.  The analysis script begins by sorting "MergeGDPandStat" by GDP ascending.  The country with the 13th lowest GDP is then identified.  The average GDP rankings for the "High income: OECD" and "High income: nonOECD" income groups is calculated.  A bar chart showing GDP per Income Group is then created and printed.  Next, each row is assigned a quantile group based upon GDP ranking.  The number of countries which are in the top 38 GDP Rankings and part of the "Lower middle income" income group.  

```{r analyze, fig.width=10}
source("CS1AnalyzeData.R")
```

## Questions and Answers
1.  Merge the data based on the country shortcode. How many of the IDs match? 
```{r}
cat("There are", Q1, "matches between GDPdata and FedSTATS.")
```

2.  Sort the data frame in ascending order by GDP (so United States is last). What is the 13th country in the resulting data frame?
```{r}
cat(MergeGDPandStat$Long.Name[13], "is the country with the 13th lowest GDP.  ")
```

3.  What are the average GDP rankings for the "High income: OECD" and "High income: nonOECD" groups?
```{r}
cat("The mean GDP ranking for High income: OECD countries is", mean(HIOECDGDP$Ranking), ".  ")
cat("The mean GDP ranking for High income: nonOECD countries is", mean(HINOECDGDP$Ranking, na.rm = TRUE), ".  ")
```

4.  Plot the GDP for all of the countries. Use ggplot2 to color your plot by Income Group.
```{r barplot, fig.width=10}
print(ggplot(MergeGDPandStat, aes(MergeGDPandStat$Income.Group, MergeGDPandStat$GDP_USD)) +geom_bar(stat = "identity", aes(fill = Income.Group)) +labs(x = "Income Group", y = "GDP"))
```

5.  Cut the GDP ranking into 5 separate quantile groups. Make a table versus Income.Group. How many countries are Lower middle income but among the 38 nations with highest GDP?
```{r}
Q5 <- subset(MergeGDPandStat, MergeGDPandStat$QuantileGroup=="1" & MergeGDPandStat$Income.Group=="Lower middle income")
cat(nrow(Q5), "countries are Lower middle income and among the 38 nations with highest GDP.  ")
```

## Conclusion
